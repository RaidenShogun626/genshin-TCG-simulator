const CharList = {
    'ssr': [
        { path: "images/Venti.png", name: "温迪", type: "character", rarity: 5 },
        { path: "images/char_zhongli.png", name: "钟离", type: "character", rarity: 5 },
        { path: "images/char_raiden.png", name: "雷电将军", type: "character", rarity: 5 },
        { path: "images/char_nahida.png", name: "纳西妲", type: "character", rarity: 5 },
        { path: "images/Klee.png", name: "可莉", type: "character", rarity: 5 },
        { path: "images/Jean.png", name: "琴", type: "character", rarity: 5 },
        { path: "images/Diluc.png", name: "迪卢克", type: "character", rarity: 5 },
        { path: "images/Eula.png", name: "优菈", type: "character", rarity: 5 },
        { path: "images/Mona.png", name: "莫娜", type: "character", rarity: 5 },
        { path: "images/Tartaglia.png", name: "达达利亚", type: "character", rarity: 5 },
        { path: "images/Xiao.png", name: "魈", type: "character", rarity: 5 },
        { path: "images/Shenhe.png", name: "申鹤", type: "character", rarity: 5 },
        { path: "images/Hu_Tao.png", name: "胡桃", type: "character", rarity: 5 },
        { path: "images/Keqing.png", name: "刻晴", type: "character", rarity: 5 },
        { path: "images/Ganyu.png", name: "甘雨", type: "character", rarity: 5 },
        { path: "images/Tighnari.png", name: "提纳里", type: "character", rarity: 5 },
        { path: "images/Cyno.png", name: "赛诺", type: "character", rarity: 5 },
        { path: "images/Yae_Miko.png", name: "八重神子", type: "character", rarity: 5 },
        { path: "images/Kamizato_Ayaka.png", name: "神里绫华", type: "character", rarity: 5 },
        { path: "images/Kamizato_Ayato.png", name: "神里绫人", type: "character", rarity: 5 },
        { path: "images/Yoimiya.png", name: "宵宫", type: "character", rarity: 5 },
        { path: "images/Sangonomiya_Kokomi.png", name: "珊瑚宫心海", type: "character", rarity: 5 },
        { path: "images/Maguu_Kenki.png", name: "魔偶剑鬼", type: "enemy", rarity: 5 },
        { path: "images/Rhodeia_of_Loch.png", name: "纯水精灵·洛蒂娅", type: "enemy", rarity: 5 },
        { path: "images/Gold_Lawachurls.png", name: "黄金王兽", type: "enemy", rarity: 5 },
        { path: "images/Jadeplume_Terrorshroom.png", name: "翠翎恐蕈", type: "enemy", rarity: 5 },
        { path: "images/Agents.png", name: "愚人众·债务处理人", type: "enemy", rarity: 5 },
        { path: "images/Mirror_Maiden.png", name: "愚人众·藏镜仕女", type: "enemy", rarity: 5 },
        { path: "images/Amos_bow.png", name: "阿莫斯之弓", type: "weapon", rarity: 5 },
        { path: "images/A_Thousand_Floating_Dreams.png", name: "千夜浮梦", type: "weapon", rarity: 5 },
        { path: "images/Engulfing_Lightning.png", name: "薙草之稻光", type: "weapon", rarity: 5 },
        { path: "images/Skyward_Atlas.png", name: "天空之卷", type: "weapon", rarity: 5 },
        { path: "images/Skyward_Harp.png", name: "天空之翼", type: "weapon", rarity: 5 },
        { path: "images/Skyward_Spine.png", name: "天空之脊", type: "weapon", rarity: 5 },
        { path: "images/Wolf_Gravestone.png", name: "狼的末路", type: "weapon", rarity: 5 }
    ],
    'sr': [
        { path: "images/Kaeya.png", name: "凯亚", type: "character", rarity: 4 },
        { path: "images/Amber.png", name: "安柏", type: "character", rarity: 4 },
        { path: "images/Barbara.png", name: "芭芭拉", type: "character", rarity: 4 },
        { path: "images/Noelle.png", name: "诺艾尔", type: "character", rarity: 4 },
        { path: "images/Diona.png", name: "迪奥娜", type: "character", rarity: 4 },
        { path: "images/Fischl.png", name: "菲谢尔", type: "character", rarity: 4 },
        { path: "images/Sucrose.png", name: "砂糖", type: "character", rarity: 4 },
        { path: "images/Razor.png", name: "雷泽", type: "character", rarity: 4 },
        { path: "images/char_bennett.png", name: "班尼特", type: "character", rarity: 4 },
        { path: "images/Ningguang.png", name: "凝光", type: "character", rarity: 4 },
        { path: "images/Beidou.png", name: "北斗", type: "character", rarity: 4 },
        { path: "images/char_xingqiu.png", name: "行秋", type: "character", rarity: 4 },
        { path: "images/Chongyun.png", name: "重云", type: "character", rarity: 4 },
        { path: "images/char_xiangling.png", name: "香菱", type: "character", rarity: 4 },
        { path: "images/Collei.png", name: "柯莱", type: "character", rarity: 4 },
        { path: "images/Kujo_Sara.png", name: "九条裟罗", type: "character", rarity: 4 },
        { path: "images/Sacrificial_Sword.png", name: "祭礼剑", type: "weapon", rarity: 4 },
        { path: "images/Sacrificial_Fragments.png", name: "祭礼残章", type: "weapon", rarity: 4 },
        { path: "images/Sacrificial_Greatsword.png", name: "祭礼大剑", type: "weapon", rarity: 4 },
        { path: "images/Sacrificial_Bow.png", name: "祭礼弓", type: "weapon", rarity: 4 },
        { path: "images/Lithic_Spear.png", name: "千岩长枪", type: "weapon", rarity: 4 },
        { path: "images/Large_Cryo_Slime.png", name: "大型冰史莱姆", type: "enemy", rarity: 4 },
        { path: "images/Large_Hydro_Slime.png", name: "大型水史莱姆", type: "enemy", rarity: 4 }
    ],
    'r': [
        { path: "images/Hydro_Slime.png", name: "水史莱姆", type: "enemy", rarity: 3 },
        { path: "images/Cryo_Slime.png", name: "冰史莱姆", type: "enemy", rarity: 3 },
        { path: "images/Electro_Slime.png", name: "雷史莱姆", type: "enemy", rarity: 3 },
        { path: "images/weapon_bow.png", name: "猎弓", type: "weapon", rarity: 3 },
        { path: "images/weapon_claymore.png", name: "训练大剑", type: "weapon", rarity: 3 },
        { path: "images/weapon_book.png", name: "讨龙英杰谭", type: "weapon", rarity: 3 },
        { path: "images/Traverler_Sword.png", name: "旅行剑", type: "weapon", rarity: 3 },
        { path: "images/White_Tassel.png", name: "白缨枪", type: "weapon", rarity: 3 }
    ]
};

function getCardNameFromPath(path) {
    // 从路径中提取文件名（不含扩展名）
    const fileName = path.split('/').pop().split('.')[0];

    // 简单的名称映射（根据你的实际图片名称调整）
    const nameMap = {
        'Venti': '温迪',
        'char_zhongli': '钟离',
        'char_raiden': '雷电将军',
        'char_nahida': '纳西妲',
        'Klee': '可莉',
        'Jean': '琴',
        'Diluc': '迪卢克',
        'Eula': '优菈',
        'Mona': '莫娜',
        'Tartaglia': '达达利亚',
        'Xiao': '魈',
        'Shenhe': '申鹤',
        'Hu_Tao': '胡桃',
        'Keqing': '刻晴',
        'Ganyu': '甘雨',
        'Tighnari': '提纳里',
        'Cyno': '赛诺',
        'Yae_Miko': '八重神子',
        'Kamizato_Ayaka': '神里绫华',
        'Kamizato_Ayato': '神里绫人',
        'Yoimiya': '宵宫',
        'Sangonomiya_Kokomi': '珊瑚宫心海',
        'Maguu_Kenki': '魔偶剑鬼',
        'Rhodeia_of_Loch': '纯水精灵',
        'Gold_Lawachurls': '黄金王兽',
        'Jadeplume_Terrorshroom': '翠翎恐蕈',
        'Agents': '债务处理人',
        'Mirror_Maiden': '藏镜仕女',
        'Amos_bow': '阿莫斯之弓',
        'A_Thousand_Floating_Dreams': '千夜浮梦',
        'Engulfing_Lightning': '薙草之稻光',
        'Skyward_Atlas': '天空之卷',
        'Skyward_Harp': '天空之翼',
        'Skyward_Spine': '天空之脊',
        'Wolf_Gravestone': '狼的末路',
        'Kaeya': '凯亚',
        'Amber': '安柏',
        'Barbara': '芭芭拉',
        'Noelle': '诺艾尔',
        'Diona': '迪奥娜',
        'Fischl': '菲谢尔',
        'Sucrose': '砂糖',
        'Razor': '雷泽',
        'char_bennett': '班尼特',
        'Ningguang': '凝光',
        'Beidou': '北斗',
        'char_xingqiu': '行秋',
        'Chongyun': '重云',
        'char_xiangling': '香菱',
        'Collei': '柯莱',
        'Kujo_Sara': '九条裟罗',
        'Sacrificial_Sword': '祭礼剑',
        'Sacrificial_Fragments': '祭礼残章',
        'Sacrificial_Greatsword': '祭礼大剑',
        'Sacrificial_Bow': '祭礼弓',
        'Lithic_Spear': '千岩长枪',
        'Large_Cryo_Slime': '大型冰史莱姆',
        'Large_Hydro_Slime': '大型水史莱姆',
        'Hydro_Slime': '水史莱姆',
        'Cryo_Slime': '冰史莱姆',
        'Electro_Slime': '雷史莱姆',
        'weapon_bow': '猎弓',
        'weapon_claymore': '训练大剑',
        'weapon_book': '讨龙英杰谭',
        'Traverler_Sword': '旅行剑',
        'White_Tassel': '白缨枪'
    };

    return nameMap[fileName] || fileName;
}

// 添加：根据图片路径判断卡牌类型
function getCardTypeFromPath(path) {
    const fileName = path.split('/').pop();

    if (fileName.includes('weapon_') ||
        fileName.includes('_bow') ||
        fileName.includes('_sword') ||
        fileName.includes('Sword') ||
        fileName.includes('Bow') ||
        fileName.includes('_book') ||
        fileName.includes('Tassel') ||
        fileName.includes('Spear') ||
        fileName.includes('Gravestone') ||
        fileName.includes('Lightning') ||
        fileName.includes('Atlas') ||
        fileName.includes('Harp') ||
        fileName.includes('Spine') ||
        fileName.includes('Dreams')) {
        return 'weapon';
    } else if (fileName.includes('Slime') ||
        fileName.includes('Lawachurl') ||
        fileName.includes('Terrorshroom') ||
        fileName.includes('Agent') ||
        fileName.includes('Maiden') ||
        fileName.includes('Maguu') ||
        fileName.includes('Rhodeia')) {
        return 'enemy';
    } else {
        return 'character';
    }
}

// 添加：根据文件夹判断稀有度
function getCardRarityFromPath(path) {
    if (path.includes('images/') && cardList.ssr.includes(path)) {
        return 5;
    } else if (path.includes('images/') && cardList.sr.includes(path)) {
        return 4;
    } else if (path.includes('images/') && cardList.r.includes(path)) {
        return 3;
    }
    return 3; // 默认3星
}

// 添加：获取随机卡牌（单抽）
function getRandomCard() {
    const random = Math.random() * 1000;

    if (random < 6) { // 0.6% 5星
        const path = cardList.ssr[Math.floor(Math.random() * cardList.ssr.length)];
        return {
            path: path,
            name: getCardNameFromPath(path),
            type: getCardTypeFromPath(path),
            rarity: 5
        };
    } else if (random < 57) { // 5.1% 4星
        const path = cardList.sr[Math.floor(Math.random() * cardList.sr.length)];
        return {
            path: path,
            name: getCardNameFromPath(path),
            type: getCardTypeFromPath(path),
            rarity: 4
        };
    } else { // 94.3% 3星
        const path = cardList.r[Math.floor(Math.random() * cardList.r.length)];
        return {
            path: path,
            name: getCardNameFromPath(path),
            type: getCardTypeFromPath(path),
            rarity: 3
        };
    }
}

// 添加：获取10连抽结果
function getTenPullResults() {
    const results = [];
    let has4Star = false;

    for (let i = 0; i < 10; i++) {
        let card;

        // 第9抽保底4星
        if (i === 8 && !has4Star) {
            const path = cardList.sr[Math.floor(Math.random() * cardList.sr.length)];
            card = {
                path: path,
                name: getCardNameFromPath(path),
                type: getCardTypeFromPath(path),
                rarity: 4
            };
            has4Star = true;
        } else {
            card = getRandomCard();
            if (card.rarity >= 4) has4Star = true;
        }

        results.push(card);
    }

    return results;
}

